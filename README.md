┌───┐                  ┌─────────┐                        ┌──────────┐┌───────────┐┌───────────┐
│SNS│                  │Boomerang│                        │ICP ledger││WaterNeuron││nICP ledger│
└─┬─┘                  └────┬────┘                        └────┬─────┘└─────┬─────┘└─────┬─────┘
  │                         │                                  │            │            │      
  │get_account_id(principal)│                                  │            │            │      
  │────────────────────────>│                                  │            │            │      
  │                         │                                  │            │            │      
  │        AccountID        │                                  │            │            │      
  │<────────────────────────│                                  │            │            │      
  │                         │                                  │            │            │      
  │          (*) TransferSnsTreasuryFunds(AccountID)           │            │            │      
  │───────────────────────────────────────────────────────────>│            │            │      
  │                         │                                  │            │            │      
  │                         Received!                          │            │            │      
  │<───────────────────────────────────────────────────────────│            │            │      
  │                         │                                  │            │            │      
  │    notify_transfer()    │                                  │            │            │      
  │────────────────────────>│                                  │            │            │      
  │                         │                                  │            │            │      
  │                         │   icrc1_balance_of(AcccountID)   │            │            │      
  │                         │─────────────────────────────────>│            │            │      
  │                         │                                  │            │            │      
  │                         │           Some(amount)           │            │            │      
  │                         │<─────────────────────────────────│            │            │      
  │                         │                                  │            │            │      
  │                         │icrc2_approve(WaterNeuron, amount)│            │            │      
  │                         │─────────────────────────────────>│            │            │      
  │                         │                                  │            │            │      
  │                         │                 icp_to_nicp()    │            │            │      
  │                         │──────────────────────────────────────────────>│            │      
  │                         │                                  │            │            │      
  │                         │                  Converted!      │            │            │      
  │                         │<──────────────────────────────────────────────│            │      
  │                         │                                  │            │            │      
  │                         │            icrc1_transfer(to SNS, nicp_amount)│            │      
  │                         │───────────────────────────────────────────────────────────>│      
┌─┴─┐                  ┌────┴────┐                        ┌────┴─────┐┌─────┴─────┐┌─────┴─────┐
│SNS│                  │Boomerang│                        │ICP ledger││WaterNeuron││nICP ledger│
└───┘                  └─────────┘                        └──────────┘└───────────┘└───────────┘

